//simply run this code in your browser in devtools, opened in task tab
var ws_protocol = "ws://";
if (window.location.protocol === "https:")
    ws_protocol = "wss://";

ws = new WebSocket(ws_protocol + window.location.host + window.location.pathname + "/broadcast");
ws.binaryType = 'arraybuffer';

function send_code(code) {
    setTimeout(1000);
    var enc = new TextEncoder();
    ws.send(enc.encode(code))
}

ws.onmessage = function (event) {
    if (typeof event.data === "string") {
        console.log(event.data);
    } else {
        var buffer = new Uint8Array(event.data);
        var dec = new TextDecoder("utf-8");
        var decoded_message = dec.decode(buffer);
        console.log(decoded_message);
        send_code(decoded_message.split("'")[1]);
    }
};